<%- include('../layouts/header') %>
  <style>
    /* Twitter Style Sidebar */
  </style>

  <div class="container-fluid">
    <div class="row">
      <%- include('../layouts/sidebar', { user: user }) %>
        <div class="col-md-9 offset-md-3">
          <div class="p-4">
              <div class="twitter-card p-4 mb-4">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h3 class="text-twitter">
                  <i class="fas fa-bell me-2"></i>Notifications
                </h3>
                <form action="/notifications/mark-all-read" method="post">
                  <button type="submit" class="btn btn-sm btn-outline-twitter">Mark all as read</button>
                </form>
              </div>

              <ul class="nav nav-tabs nav-fill mb-3">
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'all' ? 'active' : '' %>" href="/notifications?filter=all">All</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'unread' ? 'active' : '' %>"
                    href="/notifications?filter=unread">Unread</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'likes' ? 'active' : '' %>"
                    href="/notifications?filter=likes">Likes</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'replies' ? 'active' : '' %>"
                    href="/notifications?filter=replies">Replies</a>
                </li>
              </ul>

              <div class="notifications-list">
                <% if (notifications && notifications.length > 0) { %>
                  <% notifications.forEach(n=> { %>
                    <div class="notification-item <%= !n.read ? 'unread' : '' %>">
                      <% if (n.type === 'like') { %>
                        <p>
                          <strong>
                            <%= n.sender.name %>
                          </strong> liked your tweet:
                          <br>
                          <small>"<%= n.tweet && n.tweet.content ? n.tweet.content : '[tweet removed]' %>"</small>
                        </p>
                      <% } else if (n.type === 'reply') { %>
                        <p>
                          <strong>
                            <%= n.sender.name %>
                          </strong> replied to your tweet:
                          <br>
                          <small>"<%= n.tweet && n.tweet.content ? n.tweet.content : '[tweet removed]' %>"</small>
                          <p class="mt-2 mb-0">Reply content: <br>
                          <strong class="text-white-50"><%= n.content %></strong></p>
                        </p>
                      <% } %>
                      <small class="text-muted">
                        <%= new Date(n.createdAt).toLocaleString() %>
                      </small>
                    </div>
                  <% }) %>
                <% } else { %>
                  <div class="text-center text-muted py-5">
                    <i class="fas fa-bell-slash fa-3x mb-3"></i>
                    <p>No notifications</p>
                  </div>
                <% } %>
              </div>
            </div>
          </div>
        </div>
    </div>
  </div>

  <%- include('../layouts/footer') %>