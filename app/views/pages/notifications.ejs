<%- include('../layouts/header') %>
  <style>
    /* Twitter Style Sidebar */
  </style>

  <div class="container-fluid">
    <div class="row">
      <%- include('../layouts/sidebar', { user: user }) %>
        <div class="col-md-9 offset-md-3">
          <div class="p-4">
            <div class="twitter-card p-4 mb-4">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h3 class="text-twitter">
                  <i class="fas fa-bell me-2"></i>通知
                </h3>
                <form action="/notifications/mark-all-read" method="post">
                  <button type="submit" class="btn btn-sm btn-outline-twitter">标记所有已读</button>
                </form>
              </div>

              <ul class="nav nav-tabs nav-fill mb-3">
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'all' ? 'active' : '' %>" href="/notifications?filter=all">全部</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'unread' ? 'active' : '' %>"
                    href="/notifications?filter=unread">未读</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'likes' ? 'active' : '' %>"
                    href="/notifications?filter=likes">点赞</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link <%= filter === 'replies' ? 'active' : '' %>"
                    href="/notifications?filter=replies">回复</a>
                </li>
              </ul>

              <% if (notifications && notifications.length> 0) { %>
                <% notifications.forEach(n=> { %>
                  <div class="notification-item <%= !n.read ? 'unread' : '' %>">
                    <% if (n.type==='like' ) { %>
                      <p>
                        <strong>
                          <%= n.sender.name %>
                        </strong> 点赞了你的推文:
                        <br>
                        <small>"<%= n.tweet.content %>"</small>
                      </p>
                      <% } else if (n.type==='reply' ) { %>
                        <p>
                          <strong>
                            <%= n.sender.name %>
                          </strong> 回复了你的推文:
                          <br>
                          <small>"<%= n.tweet.content %>"</small>
                        </p>
                        <% } %>
                          <small class="text-muted">
                            <%= new Date(n.createdAt).toLocaleString() %>
                          </small>
                  </div>
                  <% }) %>
                    <% } else { %>
                      <div class="text-center text-muted py-5">
                        <i class="fas fa-bell-slash fa-3x mb-3"></i>
                        <p>暂无通知</p>
                      </div>
                      <% } %>
            </div>
          </div>
        </div>
    </div>
  </div>

  <%- include('../layouts/footer') %>